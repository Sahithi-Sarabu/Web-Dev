(this.webpackJsonpchat=this.webpackJsonpchat||[]).push([[0],[,,,,function(e,t,n){e.exports=n(11)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(3),c=n.n(a),s=(n(9),n(1)),u=(n(10),function(e){var t=e.onLogin,n=e.setError,a=Object(r.useState)(""),c=Object(s.a)(a,2),u=c[0],i=c[1];return Object(r.useEffect)((function(){n("")}),[]),o.a.createElement("div",{className:"login"},o.a.createElement("input",{className:"user-name",onChange:function(e){return i(e.target.value)},placeholder:"Enter name"}),o.a.createElement("button",{className:"add-user",onClick:function(){(function(e){return fetch("/session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e})}).catch((function(){return Promise.reject({error:"network-error"})})).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))}))})(u).then((function(e){t(e)})).catch((function(e){n(e.error)}))}},"Login"))}),i=function(e){var t=e.onLogout,n=e.setError;return o.a.createElement("div",{className:"logout"},o.a.createElement("button",{className:"logout-button",onClick:function(){fetch("/session",{method:"DELETE"}).catch((function(){return Promise.reject({error:"network-error"})})).then((function(e){if(!e.ok)return Promise.reject({error:"Error logging out"})})).then((function(){return t()})).catch((function(e){n(e.error)}))}},"Logout"))},m=function(e){var t=e.users,n=e.messages,r=Object.values(t).map((function(e){return o.a.createElement("li",{key:e.toString()},o.a.createElement("span",{className:"user"},e))})),a=Object.values(n).map((function(e){return o.a.createElement("li",{key:e.user+e.time},o.a.createElement("div",{className:"user-info"},o.a.createElement("span",{className:"user-name"},e.user),o.a.createElement("span",{className:"time"},e.time)),o.a.createElement("span",{className:"message"},e.message))}));return o.a.createElement("div",{className:"chat-content"},o.a.createElement("ul",{className:"users"},r),o.a.createElement("ul",{className:"messages"},a))},l=function(e){var t=e.onSend,n=e.setError,a=e.setUserState,c=Object(r.useState)(""),u=Object(s.a)(c,2),i=u[0],m=u[1];return o.a.createElement("div",{className:"to-send"},o.a.createElement("input",{className:"new-message",value:i,onChange:function(e){m(e.target.value)},placeholder:"Enter message"}),o.a.createElement("button",{className:"add",onClick:function(e){(function(e){return fetch("/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})}).catch((function(){return Promise.reject({error:"network-error"})})).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))}))})(i).then((function(e){t(e),m("")})).catch((function(e){n(e.error),"Unauthorized user"!==e.error&&"User not allowed"!==e.error||a({isLoggedIn:!1})}))}},"Send"))},f=function(e){var t=e.setUserState,n=e.setError,a=Object(r.useState)([]),c=Object(s.a)(a,2),u=c[0],f=c[1],h=Object(r.useState)([]),E=Object(s.a)(h,2),g=E[0],d=E[1],j=function(){fetch("/users",{method:"GET"}).catch((function(){return Promise.reject({error:"network-error"})})).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))})).then((function(e){f(e)})).catch((function(e){n(e.error)}))},b=function(){fetch("/messages",{method:"GET"}).catch((function(){return Promise.reject({error:"network-error"})})).then((function(e){return e.ok?e.json():e.json().then((function(e){return Promise.reject(e)}))})).then((function(e){d(e)})).catch((function(e){n(e.error)}))};return Object(r.useEffect)((function(){j(),b(),n("")}),[]),o.a.createElement("div",{className:"chat"},o.a.createElement("h2",null,"Chat On"),o.a.createElement("div",{className:"chat-area"},o.a.createElement(i,{onLogout:function(){t({isLoggedIn:!1})},setError:n}),o.a.createElement(l,{onSend:function(e){d(e)},setError:n,setUserState:t}),o.a.createElement(m,{users:u,messages:g})))},h=function(){var e=Object(r.useState)({isLoggedIn:!1}),t=Object(s.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(""),i=Object(s.a)(c,2),m=i[0],l=i[1];Object(r.useEffect)((function(){fetch("/session",{method:"GET"}).catch((function(){return Promise.reject({error:"network-error"})})).then((function(e){if(!e.ok)return Promise.reject({error:"login-invalid"})})).then((function(e){a({isLoggedIn:!0,username:e})}))}),[]);return o.a.createElement("div",{className:"App"},n.isLoggedIn?o.a.createElement(f,{setUserState:a,setError:l}):o.a.createElement(u,{onLogin:function(e){a({isLoggedIn:!0,username:e})},setError:l}),o.a.createElement("p",{className:"status"},m))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(h,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[4,1,2]]]);
//# sourceMappingURL=main.78cb7232.chunk.js.map